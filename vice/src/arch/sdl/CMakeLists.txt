add_library(libarch)

target_compile_definitions(
    libarch
    PRIVATE
        $<$<COMPILE_LANGUAGE:C>:HAVE_CONFIG_H NDEBUG _arch_dreamcast __DREAMCAST__ >
        $<$<COMPILE_LANGUAGE:CXX>:>
        $<$<COMPILE_LANGUAGE:OBJC>:>
    )

target_include_directories(
    libarch
    PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}
        ${CMAKE_CURRENT_SOURCE_DIR}/
        ${CMAKE_SOURCE_DIR}/src/arch/systemheaderoverride
        ${CMAKE_SOURCE_DIR}/src/arch/sdl
        ${CMAKE_SOURCE_DIR}/src/arch/shared
        ${CMAKE_SOURCE_DIR}/src/arch/shared/hotkeys
        ${CMAKE_SOURCE_DIR}/src
        ${CMAKE_SOURCE_DIR}/src/drive
        ${CMAKE_SOURCE_DIR}/src/printerdrv
        ${CMAKE_SOURCE_DIR}/src/c64
        ${CMAKE_SOURCE_DIR}/src/c64/cart
        ${CMAKE_SOURCE_DIR}/src/c64dtv
        ${CMAKE_SOURCE_DIR}/src/scpu64
        ${CMAKE_SOURCE_DIR}/src/c128
        ${CMAKE_SOURCE_DIR}/src/vic20
        ${CMAKE_SOURCE_DIR}/src/pet
        ${CMAKE_SOURCE_DIR}/src/cbm2
        ${CMAKE_SOURCE_DIR}/src/plus4
        ${CMAKE_SOURCE_DIR}/src/plus4/cart
        ${CMAKE_SOURCE_DIR}/src/raster
        ${CMAKE_SOURCE_DIR}/src/rs232drv
        ${CMAKE_SOURCE_DIR}/src/samplerdrv
        ${CMAKE_SOURCE_DIR}/src/sid
        ${CMAKE_SOURCE_DIR}/src/userport
        ${CMAKE_SOURCE_DIR}/src/vdrive
        ${CMAKE_SOURCE_DIR}/src/vdc
        ${CMAKE_SOURCE_DIR}/src/video
        ${CMAKE_SOURCE_DIR}/src/lib/
        ${CMAKE_SOURCE_DIR}/src/lib/p64
        ${CMAKE_SOURCE_DIR}/src/platform
        ${CMAKE_SOURCE_DIR}/src/joyport
        ${CMAKE_SOURCE_DIR}/src/gfxoutputdrv
        ${CMAKE_SOURCE_DIR}/src/tapeport
        ${CMAKE_SOURCE_DIR}/src/imagecontents
        ${CMAKE_SOURCE_DIR}/src/datasette
        ${CMAKE_SOURCE_DIR}/src/core/rtc
    )

target_compile_options(
    libarch
    PRIVATE
        $<$<COMPILE_LANGUAGE:C>:-Wno-deprecated-declarations -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter>
        $<$<COMPILE_LANGUAGE:CXX>:-Wno-deprecated-declarations -g -O3 -Wall -Wformat -Wshadow -Wpointer-arith -Wuninitialized -Wunreachable-code -Wno-unused-parameter -g -O3 -Wall -Wformat -Wshadow -Wpointer-arith -Wuninitialized -Wunreachable-code -Wno-unused-parameter>
        $<$<COMPILE_LANGUAGE:OBJC>:-Wno-deprecated-declarations >
    )

target_sources(
    libarch
    PRIVATE
        actions-cartridge.c
        actions-debug.c
        actions-display.c
        actions-drive.c
        actions-edit.c
        actions-help.c
        actions-hotkeys.c
        actions-joystick.c
        actions-machine.c
        actions-media.c
        actions-settings.c
        actions-snapshot.c
        actions-speed.c
        actions-tape.c
        actions-vsid.c
        archdep.c
        fullscreen.c
        hotkeys.c
        icon.c
        joy.c
        kbd.c
        lightpendrv.c
        menu_c128hw.c
        menu_c64cart.c
        menu_c64_common_expansions.c
        menu_c64_expansions.c
        menu_c64dtvhw.c
        menu_c64hw.c
        menu_c64model.c
        menu_cbm2cart.c
        menu_cbm2hw.c
        menu_cbm5x0hw.c
        menu_common.c
        menu_debug.c
        menu_drive.c
        menu_drive_rom.c
        menu_edit.c
        menu_ethernet.c
        menu_ethernetcart.c
        menu_ffmpeg.c
        menu_help.c
        menu_jam.c
        menu_joyport.c
        menu_joystick.c
        menu_media.c
        menu_midi.c
        menu_monitor.c
        menu_mouse.c
        menu_network.c
        menu_petcart.c
        menu_pethw.c
        menu_plus4cart.c
        menu_plus4hw.c
        menu_printer.c
        menu_ram.c
        menu_reset.c
        menu_rom.c
        menu_rs232.c
        menu_sampler.c
        menu_scpu64hw.c
        menu_screenshot.c
        menu_settings.c
        menu_sid.c
        menu_snapshot.c
        menu_sound.c
        menu_speed.c
        menu_tape.c
        menu_userport.c
        menu_vic20cart.c
        menu_vic20hw.c
        menu_video.c
        menu_wic64.c
        mousedrv.c
        sdlmain.c
        ui.c
        uifonts.c
        uifilereq.c
        uiimagefilereq.c
        uihotkey.c
        uimenu.c
        uimon.c
        uimsgbox.c
        uipause.c
        uipoll.c
        uistatusbar.c
        video_sdl1.c
        vkbd.c
        vsidui.c
        vsyncarch.c
        x128_ui.c
        x64_ui.c
        x64dtv_ui.c
        x64sc_ui.c
        xcbm2_ui.c
        xcbm5x0_ui.c
        xpet_ui.c
        xplus4_ui.c
        xscpu64_ui.c
        xvic_ui.c
        actions-cartridge.h
        actions-debug.h
        actions-display.h
        actions-drive.h
        actions-edit.h
        actions-help.h
        actions-hotkeys.h
        actions-joystick.h
        actions-machine.h
        actions-media.h
        actions-settings.h
        actions-snapshot.h
        actions-speed.h
        actions-tape.h
        actions-vsid.h
        archdep.h
        fullscreenarch.h
        hotkeys.h
        icon.h
        joy.h
        kbd.h
        lightpendrv.h
        menu_c128hw.h
        menu_c64cart.h
        menu_c64_common_expansions.h
        menu_c64_expansions.h
        menu_c64dtvhw.h
        menu_c64hw.h
        menu_c64model.h
        menu_cbm2cart.h
        menu_cbm2hw.h
        menu_cbm5x0hw.h
        menu_common.h
        menu_debug.h
        menu_drive.h
        menu_drive_rom.h
        menu_edit.h
        menu_ethernet.h
        menu_ethernetcart.h
        menu_ffmpeg.h
        menu_help.h
        menu_jam.h
        menu_joyport.h
        menu_joystick.h
        menu_media.h
        menu_midi.h
        menu_monitor.h
        menu_mouse.h
        menu_network.h
        menu_petcart.h
        menu_pethw.h
        menu_plus4cart.h
        menu_plus4hw.h
        menu_printer.h
        menu_ram.h
        menu_reset.h
        menu_rom.h
        menu_rs232.h
        menu_sampler.h
        menu_scpu64hw.h
        menu_screenshot.h
        menu_settings.h
        menu_sid.h
        menu_snapshot.h
        menu_sound.h
        menu_speed.h
        menu_tape.h
        menu_userport.h
        menu_vic20cart.h
        menu_vic20hw.h
        menu_video.h
        menu_wic64.h
        mousedrv.h
        ui.h
        uifonts.h
        uifilereq.h
        uihotkey.h
        uimenu.h
        uimsgbox.h
        uipoll.h
        uistatusbar.h
        videoarch.h
        vkbd.h
        vsidui_sdl.h
        vice_sdl.h
    )

add_library(libtoolarch)

target_compile_definitions(
    libtoolarch
    PRIVATE
        $<$<COMPILE_LANGUAGE:C>:HAVE_CONFIG_H NDEBUG _arch_dreamcast __DREAMCAST__ >
        $<$<COMPILE_LANGUAGE:CXX>:>
        $<$<COMPILE_LANGUAGE:OBJC>:>
    )

target_include_directories(
    libtoolarch
    PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}
        ${CMAKE_CURRENT_SOURCE_DIR}/
        ${CMAKE_SOURCE_DIR}/src/arch/systemheaderoverride
        ${CMAKE_SOURCE_DIR}/src/arch/sdl
        ${CMAKE_SOURCE_DIR}/src/arch/shared
        ${CMAKE_SOURCE_DIR}/src/arch/shared/hotkeys
        ${CMAKE_SOURCE_DIR}/src
        ${CMAKE_SOURCE_DIR}/src/drive
        ${CMAKE_SOURCE_DIR}/src/printerdrv
        ${CMAKE_SOURCE_DIR}/src/c64
        ${CMAKE_SOURCE_DIR}/src/c64/cart
        ${CMAKE_SOURCE_DIR}/src/c64dtv
        ${CMAKE_SOURCE_DIR}/src/scpu64
        ${CMAKE_SOURCE_DIR}/src/c128
        ${CMAKE_SOURCE_DIR}/src/vic20
        ${CMAKE_SOURCE_DIR}/src/pet
        ${CMAKE_SOURCE_DIR}/src/cbm2
        ${CMAKE_SOURCE_DIR}/src/plus4
        ${CMAKE_SOURCE_DIR}/src/plus4/cart
        ${CMAKE_SOURCE_DIR}/src/raster
        ${CMAKE_SOURCE_DIR}/src/rs232drv
        ${CMAKE_SOURCE_DIR}/src/samplerdrv
        ${CMAKE_SOURCE_DIR}/src/sid
        ${CMAKE_SOURCE_DIR}/src/userport
        ${CMAKE_SOURCE_DIR}/src/vdrive
        ${CMAKE_SOURCE_DIR}/src/vdc
        ${CMAKE_SOURCE_DIR}/src/video
        ${CMAKE_SOURCE_DIR}/src/lib/
        ${CMAKE_SOURCE_DIR}/src/lib/p64
        ${CMAKE_SOURCE_DIR}/src/platform
        ${CMAKE_SOURCE_DIR}/src/joyport
        ${CMAKE_SOURCE_DIR}/src/gfxoutputdrv
        ${CMAKE_SOURCE_DIR}/src/tapeport
        ${CMAKE_SOURCE_DIR}/src/imagecontents
        ${CMAKE_SOURCE_DIR}/src/datasette
        ${CMAKE_SOURCE_DIR}/src/core/rtc
    )

target_compile_options(
    libtoolarch
    PRIVATE
        $<$<COMPILE_LANGUAGE:C>:-Wno-deprecated-declarations -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter -g -O3 -W -Wall -Wextra -Wformat -Wformat-signedness -Wformat-security -Wshadow -Wpointer-arith -Wmissing-prototypes -Wstrict-prototypes -Wuninitialized -Wmissing-field-initializers -Wunreachable-code -Wdiscarded-qualifiers -Wno-unknown-pragmas -Wunused-but-set-variable -Wno-sign-compare -Wno-ignored-qualifiers -Wno-unused-parameter>
        $<$<COMPILE_LANGUAGE:CXX>:-Wno-deprecated-declarations -g -O3 -Wall -Wformat -Wshadow -Wpointer-arith -Wuninitialized -Wunreachable-code -Wno-unused-parameter -g -O3 -Wall -Wformat -Wshadow -Wpointer-arith -Wuninitialized -Wunreachable-code -Wno-unused-parameter>
        $<$<COMPILE_LANGUAGE:OBJC>:-Wno-deprecated-declarations >
    )

target_sources(
    libtoolarch
    PRIVATE
        archdep.c
        vice_sdl.h
    )

