<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>vsid: arch/shared/rs232-unix-dev.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../vice-logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">vsid<span id="projectnumber">&#160;3.8</span>
   </div>
   <div id="projectbrief">Versatile Commodore Emulator and Virtual Commodore Environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d6/dd8/rs232-unix-dev_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">rs232-unix-dev.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>RS232 Device emulation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dc/d6b/vice_8h_source.html">vice.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd8/rs232-unix-dev_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></td></tr>
<tr class="separator:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >RS232 Device emulation. </p>
<dl class="section author"><dt>Author</dt><dd>Andre Fachat <a href="#" onclick="location.href='mai'+'lto:'+'fac'+'ha'+'t@w'+'eb'+'.de'; return false;">facha<span class="obfuscator">.nosp@m.</span>t@we<span class="obfuscator">.nosp@m.</span>b.de</a></dd></dl>
<p>The RS232 emulation captures the bytes sent to the RS232 interfaces available (currently ACIA 6551, std C64 and Daniel Dallmanns fast RS232 with 9600 Baud). The characters captured are sent to a file or an attached process. Characters sent from a process are sent back to the chip emulations.</p>
<p >There are four RS232 "output" devices that can be defined, so you can switch between them easily: rsdev1-4. Each device definition contains the output filename (see rsdev1-4 cmdline options resp. RsDevice1-4 resources in <a class="el" href="../../dc/d71/rs232drv_8c.html">rs232drv.c</a>), that determines the action when opening up a serial device.</p>
<p >If that name starts with a pipe symbol "|", the remaining name is interpreted as program to start and RS232 data from the emulation is piped to that program and vice versa.</p>
<p >If that name is a Unix TTY device (and not a file), the emulator detects that and sets up the device as serial device, using the baud rate from the -rsdev[1-4]baud command line option. So for example you can have the emulator talk to a serial port on the host PC using /dev/ttyS0 (name depending on your Linux/Unix distribution) and use the baud rate given in the -rsdev?baud for the external interface.</p>
<p >If that name is a file, then just the RS232 output is written there.</p>
<p >Note: there seems to be some extension in <a class="el" href="../../dc/d71/rs232drv_8c.html">rs232drv.c</a> to use some network connection, but I don't know how that works.</p>
<p >To use the output device, you have to select one for each of the emulated RS232 device. So, to use rsdev1 in the C64 userport RS232 emulation, you have to use the "-rsuser" to enable the userport emulation and "-rsuserdev 0" to select rsdev1 (unfortunately there is an offset of one). And as the userport emulation can not detect the baud rate that is used to shift the bits (as opposed to the ACIA emulation where the baud rate is set in a register), you also have to use "-rsuserbaud 2400" to set this emulated baud rate.</p>
<p >Example: x64sc -rsuser -rsuserdev 2 -rsuserbaud 2400 -rsdev3 /dev/ttyUSB0 -rsdev3baud 9600 lets you run your userport emulation with 2400 baud (OPEN 1,2,0,CHR$(10)+CHR$(0)), and connects it to a USB-to-serial port device under /dev/ttyUSB0, that runs its RS232 with 9600 baud. If you have two USB-to-serial port devices connected to the same PC, you could then run a terminal program on the other serial port with 9600 baud to connect to the emulated C64.</p>
<p >Implementation note:</p><ul>
<li>the T_* definitions below determine the type of serial device, TTY, file, or program.</li>
<li>the fd[] array is a list of opened RS232 devices (where the index does not match with the device number, but most likely the order in which the device was opened - so the first opened device is in slot fd[0], the second one in fd[1] etc). Maybe a bit oversophisticated, but you could use the same PROC device for multiple RS232 emulations, e.g. use rsdev1 for both userport and ACIA, as for each opening of the device, a new process is started. (not sure if that would work with a Unix pipe to have them talk to each other). </li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad72dbcf6d0153db1b8d8a58001feed83" name="ad72dbcf6d0153db1b8d8a58001feed83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72dbcf6d0153db1b8d8a58001feed83">&#9670;&nbsp;</a></span>DEBUG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_70d5e250c66d001b18da37689179cade.html">arch</a></li><li class="navelem"><a class="el" href="../../dir_5086f1a04931b40f3acc880d3decc865.html">shared</a></li><li class="navelem"><a class="el" href="../../d6/dd8/rs232-unix-dev_8c.html">rs232-unix-dev.c</a></li>
    <li class="footer">Generated on Sun Jun 16 2024 16:42:48 for vsid by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
