<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>x128: building the SDL ports</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../vice-logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">x128<span id="projectnumber">&#160;3.8</span>
   </div>
   <div id="projectbrief">Versatile Commodore Emulator and Virtual Commodore Environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/d51/buildsdl.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">building the SDL ports </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><tt>
Building the SDL port of VICE<br>
-----------------------------<br>
<br>
VICE can link against either SDL1 or SDL2 depending on how it is<br>
configured. Despite being different versions of the "same library",<br>
they are neither API nor binary compatible and connot be<br>
simultaneously linked. You will need to pick one to use.<br>
<br>
Generally speaking, if SDL2 is available on your target system, that<br>
is the build you want -- SDL2 provides more efficient use of modern OS<br>
facilities with fewer external dependencies required. SDL1 is really<br>
useful only if:<br>
<br>
- You are building for a system without graphical acceleration of any<br>
&nbsp;&nbsp;kind or for a system with graphical acceleration but which is<br>
&nbsp;&nbsp;difficult or finicky to use (like the default Raspberry Pi setup).<br>
- SDL2 isn't available on your system at all (BeOS, RISC OS,<br>
&nbsp;&nbsp;etc). OpenGL will be available if the platform supports it.<br>
<br>
<br>
Building in *nix compile enviroments<br>
------------------------------------<br>
<br>
If you have checked out the unstable svn version of VICE you need to generate<br>
the configure script first by doing:<br>
./autogen.sh<br>
<br>
The stable tarball already has the configure script, so continue with:<br>
<br>
./configure --enable-sdl2ui<br>
make<br>
make install<br>
<br>
You'll need the SDL2 libs and headers. Movie recording needs the<br>
FFMPEG libraries and headers.<br>
<br>
== TODO: list proper deps ==<br>
<br>
libsdl2-dev<br>
libsdl2-image-dev<br>
<br>
<br>
<br>
To build SDL1, pass --enable-sdl1ui to configure instead of --enable-sdl2ui,<br>
and you will need OpenGL headers and libraries as well if you want free-scaling.<br>
<br>
<br>
<br>
Steps to set up the needed external SDL libs for building using with minGW<br>
--------------------------------------------------------------------------<br>
<br>
(For instructions on using MSYS2 and SDL2 on Windows, see further down this<br>
 document: "Building on Windows with MSYS2")<br>
<br>
1. You will need to download the current version of SDL headers and libs for minGW. <br>
&nbsp;&nbsp; They can be found here https://www.libsdl.org/release/SDL-devel-1.2.15-mingw32.tar.gz<br>
2. Locate your minGW install include directory (ex. C:\MinGW\include), and<br>
&nbsp;&nbsp; create a directory called SDL there (ex. C:\MinGW\include\SDL). Inside this<br>
&nbsp;&nbsp; directory, copy all your SDL header (.h) files extracted in the SDL 'include' <br>
&nbsp;&nbsp; directory from step #1<br>
3. Locate your minGW library directory (ex. C:\MinGW\lib). Inside this directory, <br>
&nbsp;&nbsp; copy all your SDL libs (.a) files extracted into the SDL 'lib' directory from step #1<br>
4. Follow the standard build instructions for *nix environment now<br>
5. After making, type 'make bindist' to create the binary distribution files. They <br>
&nbsp;&nbsp; will appear in a newly created SDLVICE directory. <br>
<br>
NOTE: The default SDL build does not statically link the mingw and sdl runtime libs, <br>
so you will need to locate and copy the SDL.dll from found in step #1 and the minGW <br>
libstdc++.dll &amp; libgcc.dll files from the minGW (ex. C:\MinGW\bin) directory to a global<br>
windows path (ex. \WINDOWS\system32) or you can just drop them in the local SDLVICE <br>
binary dir so they can be found during runtime.<br>
<br>
<br>
<br>
Building on macOS<br>
-----------------<br>
<br>
See macOS-Howto.txt<br>
<br>
<br>
Building on Windows with MSYS2<br>
==============================<br>
<br>
To build the SDL version on Windows, we use the MinGW toolchain as provided by<br>
the MSYS2 project: https://www.msys2.org/<br>
<br>
We'll be using the x86_64 version in this guide, and we'll install it into<br>
C:\opt\msys64. So download and install the lastest x86_64 installer and follow<br>
the instructions on the msys2 website.<br>
MSYS2 shell commands will be indicated with '$' from now on.<br>
<br>
Make sure to have at least 3-4 GB free, preferably a few more, msys2 takes up<br>
quite a bit of space (2GB+) and VICE's trunk is also nothing to sneeze at.<br>
<br>
<br>
Install development packages<br>
----------------------------<br>
<br>
After installing the msys2 base system we need a "few" more packages, so:<br>
<br>
$ pacboy sync base-devel: pkg-config gcc ntldd zip: subversion: SDL2 libpng \<br>
&nbsp;&nbsp;SDL2_image<br>
<br>
Select 'all' for the base-devel group, then proceed to install a few packages,<br>
perhaps grab a beer, have some coffee or tea while msys2 does its magic.<br>
<br>
Now we need the xa assembler to build the VSID driver, which isn't in the MSYS2<br>
repo, so we'll build it ourselves:<br>
<br>
$ wget https://www.floodgap.com/retrotech/xa/dists/xa-2.3.11.tar.gz<br>
$ tar -xvzf xa-2.3.11.tar.gz<br>
$ cd xa-2.3.11<br>
$ make<br>
$ make install<br>
$ cd ~<br>
<br>
<br>
Check out VICE via SVN and create a minimal SDL2 build<br>
------------------------------------------------------<br>
<br>
$ svn checkout https://svn.code.sf.net/p/vice-emu/code/trunk vice-trunk<br>
<br>
(If you need write access to SVN, you'll need to install openssh and check out<br>
 trunk with the svn+ssh protocol)<br>
<br>
Change to the vice dir and see if we can build the SDL2 VICE UI:<br>
<br>
$ cd vice-trunk/vice<br>
# Generate the required build system files, such as configure:<br>
$ ./autogen.sh<br>
<br>
Now let's try to configure a minimal working SDL2 build:<br>
<br>
$ ./configure --enable-sdl2ui<br>
(This will take a while on Windows, be patient)<br>
<br>
Once this passes succesfully, we can try to actually build SDL2-VICE:<br>
<br>
$ make<br>
(Or, to collect any warnings during building: make 2&gt;&amp;1 | tee build.log)<br>
<br>
Once this succesfully finishes, we can try to run x64sc:<br>
<br>
# Create a temorary dir with the files needed for x64sc (ROMs, keymaps, palette<br>
# files, etc):<br>
$ mkdir ~/alldata-c64<br>
$ cp data/C64/* ~/alldata-c64<br>
$ cp data/DRIVES/* ~/alldata-c64<br>
<br>
Now run x64sc using this directory for the data files:<br>
$ src/x64sc -directory ~/alldata-c64<br>
<br>
If that works, building SDL2-VICE worked!<br>
<br>
<br>
Creating a proper install<br>
-------------------------<br>
<br>
Now we can create a proper directory with all required files:<br>
$ make bindist<br>
<br>
If you see a warning about binaries being optimized for your system: if you<br>
won't redistribute your bindist then all is fine, if you do plan to<br>
redistribute, than you should pass --enable-arch=no to ./configure. (In that<br>
case you'll have to do a make clean first to make sure the new configure switch<br>
is properly used to rebuild all object files)<br>
<br>
Now start cmd.exe and cd into the bindist dir:<br>
<br>
$ cd \opt\msys64\home\compyx\vice-trunk\vice\SDL2VICE-3.5-win64-r40371<br>
# (Obviously alter the above to match your path)<br>
$ x64sc<br>
# Maybe test a few others, for example xpet:<br>
$ xpet<br>
<br>
If this works you can copy the SDL2VICE-3.* dir to where you want it and rename<br>
it if required. For example copy/movce it to C:\opt\vice-sdl2 and update your<br>
Windows' $PATH to contain 'C:\opt\vice-sdl2'<br>
<br>
<br>
Creating a SDL(1.2) Version Instead of SDL2<br>
-----------------------------------------<br>
<br>
Almost identical to above except for following:<br>
<br>
Installing Dependencies:<br>
$ pacboy sync base-devel: pkg-config gcc ntldd zip: subversion: SDL libpng \<br>
&nbsp;&nbsp;SDL_image<br>
<br>
Configure:<br>
$ ./configure --enable-sdl1ui<br>
<br>
The bindist folder will be named SDLVICE-3.*<br>
<br>
<br>
Adding features (TODO)<br>
----------------------<br>
<br>
* building documentation (set up and use MikTeX)<br>
* network support (pcap)<br>
* screenshot support (jpeg, gif)<br>
<br>
-- Compyx, 2020-01-19<br>
<br>
<br>
<br>
Building the SDL2 port from trunk on Debian and Debian-derived distros<br>
======================================================================<br>
<br>
Install prerequisites<br>
---------------------<br>
<br>
$ sudo apt install autoconf automake build-essential byacc flex texinfo \<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; texlive-binaries subversion dos2unix xa65<br>
<br>
# Install SDL2 libs/headers:<br>
$ sudo apt install libsdl2-dev libsdl2-image-dev<br>
<br>
# Download VICE trunk:<br>
$ svn checkout https://svn.code.sf.net/p/vice-emu/code/trunk vice-trunk<br>
<br>
# Run autogen.sh to generate the build system:<br>
$ cd vice-trunk/vice<br>
$ ./autogen.sh<br>
<br>
# Run configure with a minimal set of switches:<br>
$ ./configure --enable-sdl2ui --with-sdlsound --without-png<br>
<br>
If that passes, it's time to build VICE:<br>
(The redirection of stdout and stderr to a file means we can inspect any errors)<br>
$ make -j 2&gt;&amp;1 | tee build.log<br>
<br>
If that succeeds without errors, it's time to install:<br>
$ sudo make install<br>
<br>
<br>
Now just enter `x64sc` in a terminal and VICE will run.<br>
</tt>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Developer Information</a></li><li class="navelem"><a class="el" href="../../d4/d5a/howtobuild.html">How to build VICE</a></li>
    <li class="footer">Generated on Sun Jun 16 2024 16:43:06 for x128 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
